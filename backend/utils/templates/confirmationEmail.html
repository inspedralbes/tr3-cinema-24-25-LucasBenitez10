<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Confirmación de Compra</title>
  </head>
  <body
    style="
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', Arial, sans-serif;
      background-color: #121212;
      color: #ffffff;
    "
  >
    <table
      role="presentation"
      width="100%"
      cellspacing="0"
      cellpadding="0"
      border="0"
    >
      <tr>
        <td
          style="padding: 20px 0; text-align: center; background-color: #e50914"
        >
          <h1 style="margin: 0; font-size: 24px; font-weight: bold">
            CinemaBar
          </h1>
        </td>
      </tr>
      <tr>
        <td style="padding: 40px 30px; background-color: #1e1e1e">
          <table
            role="presentation"
            width="100%"
            cellspacing="0"
            cellpadding="0"
            border="0"
          >
            <tr>
              <td>
                <h2 style="color: #ffffff; margin-top: 0">
                  ¡Compra Confirmada!
                </h2>
                <p style="color: #cccccc; font-size: 16px; line-height: 1.5">
                  Hola {{customerName}},
                </p>
                <p style="color: #cccccc; font-size: 16px; line-height: 1.5">
                  Tu compra de entradas ha sido confirmada. A continuación,
                  encontrarás los detalles de tu reserva:
                </p>

                <table
                  role="presentation"
                  width="100%"
                  cellspacing="0"
                  cellpadding="10"
                  border="0"
                  style="margin: 30px 0; border-collapse: collapse"
                >
                  <tr style="background-color: #252525">
                    <td
                      colspan="2"
                      style="
                        border-bottom: 1px solid #444;
                        padding: 15px;
                        text-align: center;
                      "
                    >
                      <h3 style="margin: 0; color: #e50914; font-size: 20px">
                        {{movieTitle}}
                      </h3>
                    </td>
                  </tr>
                  <tr style="background-color: #252525">
                    <td
                      style="
                        border-bottom: 1px solid #444;
                        padding: 10px;
                        color: #cccccc;
                        width: 40%;
                      "
                    >
                      Sala:
                    </td>
                    <td
                      style="
                        border-bottom: 1px solid #444;
                        padding: 10px;
                        color: #ffffff;
                        font-weight: bold;
                      "
                    >
                      {{roomName}}
                    </td>
                  </tr>
                  <tr style="background-color: #252525">
                    <td
                      style="
                        border-bottom: 1px solid #444;
                        padding: 10px;
                        color: #cccccc;
                      "
                    >
                      Fecha:
                    </td>
                    <td
                      style="
                        border-bottom: 1px solid #444;
                        padding: 10px;
                        color: #ffffff;
                        font-weight: bold;
                      "
                    >
                      {{screeningDate}}
                    </td>
                  </tr>
                  <tr style="background-color: #252525">
                    <td
                      style="
                        border-bottom: 1px solid #444;
                        padding: 10px;
                        color: #cccccc;
                      "
                    >
                      Hora:
                    </td>
                    <td
                      style="
                        border-bottom: 1px solid #444;
                        padding: 10px;
                        color: #ffffff;
                        font-weight: bold;
                      "
                    >
                      {{screeningTime}}
                    </td>
                  </tr>
                </table>

                <h3 style="color: #e50914; margin-top: 30px">Tus Entradas</h3>
                <table
                  role="presentation"
                  width="100%"
                  cellspacing="0"
                  cellpadding="10"
                  border="0"
                  style="border-collapse: collapse; margin-bottom: 30px"
                >
                  <tr style="background-color: #333333; color: #ffffff">
                    <th
                      style="
                        padding: 10px;
                        text-align: left;
                        border-bottom: 1px solid #444;
                      "
                    >
                      Código
                    </th>
                    <th
                      style="
                        padding: 10px;
                        text-align: left;
                        border-bottom: 1px solid #444;
                      "
                    >
                      Asiento
                    </th>
                    <th
                      style="
                        padding: 10px;
                        text-align: left;
                        border-bottom: 1px solid #444;
                      "
                    >
                      Tipo
                    </th>
                    <th
                      style="
                        padding: 10px;
                        text-align: right;
                        border-bottom: 1px solid #444;
                      "
                    >
                      Precio
                    </th>
                  </tr>
                  {{#each tickets}}
                  <tr style="background-color: #252525">
                    <td
                      style="
                        padding: 10px;
                        border-bottom: 1px solid #444;
                        color: #cccccc;
                      "
                    >
                      {{this.ticketCode}}
                    </td>
                    <td
                      style="
                        padding: 10px;
                        border-bottom: 1px solid #444;
                        color: #cccccc;
                      "
                    >
                      {{this.seats.row}}{{this.seats.number}}
                    </td>
                    <td
                      style="
                        padding: 10px;
                        border-bottom: 1px solid #444;
                        color: #cccccc;
                      "
                    >
                      {{this.ticketTypeCode}}
                    </td>
                    <td
                      style="
                        padding: 10px;
                        border-bottom: 1px solid #444;
                        color: #cccccc;
                        text-align: right;
                      "
                    >
                      {{this.pricePaid}} €
                    </td>
                  </tr>
                  {{/each}}
                  <tr style="background-color: #333333">
                    <td
                      colspan="3"
                      style="
                        padding: 10px;
                        text-align: right;
                        font-weight: bold;
                        color: #ffffff;
                      "
                    >
                      Total:
                    </td>
                    <td
                      style="
                        padding: 10px;
                        text-align: right;
                        font-weight: bold;
                        color: #ffffff;
                      "
                    >
                      {{totalPrice}} €
                    </td>
                  </tr>
                </table>

                <div
                  style="
                    background-color: #252525;
                    padding: 20px;
                    border-radius: 5px;
                    margin-top: 30px;
                  "
                >
                  <h3 style="color: #e50914; margin-top: 0">
                    Información Importante
                  </h3>
                  <p style="color: #cccccc; margin-bottom: 10px">
                    • Llega al menos 15 minutos antes de la función
                  </p>
                  <p style="color: #cccccc; margin-bottom: 10px">
                    • Presenta este email o el código QR en la entrada
                  </p>
                  <p style="color: #cccccc; margin-bottom: 0">
                    • Las cancelaciones solo son posibles hasta 2 horas antes de
                    la función
                  </p>
                </div>

                <div style="text-align: center; margin-top: 40px">
                  <div
                    style="
                      display: inline-block;
                      background-color: #e50914;
                      border-radius: 5px;
                    "
                  >
                    <div style="text-align: center; margin: 30px">
                      <h3 style="color: #ffffff; margin-bottom: 15px">
                        Tu Código QR
                      </h3>
                      <p style="color: #ffffff; margin-bottom: 15px">
                        Presenta este código QR en la entrada del cine
                      </p>
                      <!-- Usar imagen adjunta con CID en lugar de data URL -->
                      <img
                        src="cid:ticket-qr-code"
                        alt="Código QR de entrada"
                        style="
                          max-width: 200px;
                          height: auto;
                          background-color: #ffffff;
                          padding: 10px;
                        "
                      />
                      <!-- Imagen de respaldo por si falla la principal -->
                      <img
                        src="{{qrCodeImage}}"
                        alt="Código QR de entrada"
                        style="display: none"
                      />
                      <p
                        style="
                          color: #ffffff;
                          margin-top: 10px;
                          font-size: 12px;
                        "
                      >
                        Código de referencia: {{masterTicketCode}}
                      </p>
                    </div>
                    <a
                      href="{{ticketUrl}}"
                      style="
                        display: block;
                        color: #ffffff;
                        font-weight: bold;
                        text-decoration: none;
                        padding: 12px 25px;
                      "
                      >Ver Mis Entradas</a
                    >
                  </div>
                </div>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td
          style="
            padding: 20px;
            text-align: center;
            background-color: #121212;
            color: #888888;
            font-size: 12px;
          "
        >
          <p>&copy; 2024 CinemaBar. Todos los derechos reservados.</p>
          <p>
            Si tienes alguna duda, contáctanos en
            <a
              href="mailto:info@cinemabar.com"
              style="color: #e50914; text-decoration: none"
              >info@cinemabar.com</a
            >
          </p>
        </td>
      </tr>
    </table>
  </body>
</html>
